<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tienda de Amor y Amistad - Lesly</title>
    <meta name="description" content="Un espacio c√°lido para encontrar productos y regalos de amor, amistad y reconciliaci√≥n.">
    
    <!-- Preconnect to Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --color-primario: #e91e63;
            --color-secundario: #f8bbd0;
            --color-fondo-inicio: #fff1f2;
            --color-fondo-fin: #ffe4e8;
            --color-tarjeta-fondo: rgba(255, 255, 255, 0.8);
            --color-tarjeta-borde: #fde4ec;
            --color-texto-principal: #5c2c3b;
            --color-texto-secundario: #8d6375;
            --color-sombra: rgba(233, 30, 99, 0.15);
            --borde-radio: 16px;
            --fuente-principal: 'Poppins', sans-serif;
            --fuente-titulos: 'Playfair Display', serif;
            --ancho-tarjeta: 310px;
            --alto-tarjeta: 400px;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: var(--fuente-principal);
            background: linear-gradient(135deg, var(--color-fondo-inicio), var(--color-fondo-fin));
            background-attachment: fixed;
            color: var(--color-texto-principal);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Corazones flotantes de fondo */
        .corazones-fondo {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: -1;
        }

        .corazon {
            position: absolute;
            bottom: -100px;
            background-color: var(--color-primario);
            animation: flotar 25s infinite;
            opacity: 0;
        }

        .corazon::before,
        .corazon::after {
            content: "";
            position: absolute;
            width: 100%;
            height: 100%;
            background-color: var(--color-primario);
            border-radius: 50%;
        }

        .corazon::before {
            top: -50%;
            left: 0;
        }

        .corazon::after {
            top: 0;
            left: -50%;
        }

        @keyframes flotar {
            0% {
                transform: translateY(0) rotate(-45deg);
                opacity: 0.5;
            }
            100% {
                transform: translateY(-120vh) rotate(-45deg);
                opacity: 0;
            }
        }

        /* Estilos espec√≠ficos para cada coraz√≥n */
        .corazon:nth-child(1) {
            left: 10%;
            width: 20px;
            height: 20px;
            animation-duration: 15s;
            animation-delay: 0s;
        }

        .corazon:nth-child(2) {
            left: 20%;
            width: 15px;
            height: 15px;
            animation-duration: 20s;
            animation-delay: 2s;
            opacity: 0.3;
        }

        .corazon:nth-child(3) {
            left: 30%;
            width: 25px;
            height: 25px;
            animation-duration: 25s;
            animation-delay: 5s;
        }

        .corazon:nth-child(4) {
            left: 40%;
            width: 10px;
            height: 10px;
            animation-duration: 18s;
            animation-delay: 1s;
            opacity: 0.4;
        }

        .corazon:nth-child(5) {
            left: 50%;
            width: 30px;
            height: 30px;
            animation-duration: 12s;
            animation-delay: 3s;
        }

        .corazon:nth-child(6) {
            left: 60%;
            width: 18px;
            height: 18px;
            animation-duration: 22s;
            animation-delay: 6s;
        }

        .corazon:nth-child(7) {
            left: 70%;
            width: 12px;
            height: 12px;
            animation-duration: 17s;
            animation-delay: 4s;
            opacity: 0.5;
        }

        .corazon:nth-child(8) {
            left: 80%;
            width: 22px;
            height: 22px;
            animation-duration: 19s;
            animation-delay: 8s;
        }

        .corazon:nth-child(9) {
            left: 90%;
            width: 16px;
            height: 16px;
            animation-duration: 24s;
            animation-delay: 7s;
        }

        .corazon:nth-child(10) {
            left: 5%;
            width: 14px;
            height: 14px;
            animation-duration: 16s;
            animation-delay: 9s;
            opacity: 0.3;
        }

        .corazon:nth-child(11) {
            left: 95%;
            width: 28px;
            height: 28px;
            animation-duration: 28s;
            animation-delay: 1s;
        }

        .corazon:nth-child(12) {
            left: 45%;
            width: 19px;
            height: 19px;
            animation-duration: 14s;
            animation-delay: 10s;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Contenedor principal */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Encabezado */
        .header {
            background-color: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px);
            padding: 15px 30px;
            border-bottom: 1px solid var(--color-tarjeta-borde);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .logo {
            font-family: var(--fuente-titulos);
            font-size: 2.2em;
            font-weight: 700;
            color: var(--color-primario);
            text-decoration: none;
        }

        /* Controles de b√∫squeda */
        .controles-busqueda {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        .input-estilizado {
            background-color: #fff;
            border: 1px solid var(--color-secundario);
            color: var(--color-texto-principal);
            border-radius: var(--borde-radio);
            padding: 10px 15px;
            transition: all 0.3s ease;
        }

        .input-estilizado:focus {
            outline: none;
            border-color: var(--color-primario);
            box-shadow: 0 0 10px var(--color-sombra);
        }

        #buscador {
            width: 250px;
            padding-left: 40px;
        }

        .buscador-wrapper {
            position: relative;
        }

        .buscador-wrapper::before {
            content: 'üíñ';
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            opacity: 0.7;
        }

        #ordenar {
            appearance: none;
            -webkit-appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23e91e63' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 1.2em;
            padding-right: 35px;
        }

        /* Grid de productos */
        #product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, var(--ancho-tarjeta));
            gap: 30px;
            padding: 40px 0;
            justify-content: center;
        }

        /* Tarjetas de producto */
        .product-card {
            width: var(--ancho-tarjeta);
            height: var(--alto-tarjeta);
            background: var(--color-tarjeta-fondo);
            border: 1px solid var(--color-tarjeta-borde);
            border-radius: var(--borde-radio);
            backdrop-filter: blur(5px);
            box-shadow: 0 8px 32px 0 var(--color-sombra);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            position: relative;
            cursor: pointer;
            opacity: 0;
            animation: fadeInUp 0.5s ease-out forwards;
        }

        .product-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 12px 40px var(--color-sombra);
        }

        .card-media-container {
            width: 100%;
            height: 50%;
            overflow: hidden;
            position: relative;
            background-color: #fce4ec;
        }

        .card-media-container .card-media {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.4s ease-out;
        }

        .product-card:hover .card-media {
            transform: scale(1.1);
        }

        .card-price {
            position: absolute;
            bottom: 10px;
            right: 10px;
            background-color: var(--color-primario);
            color: #fff;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.9em;
            z-index: 2;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .card-content {
            padding: 20px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            flex-grow: 1;
            overflow: hidden;
        }

        .card-title {
            font-family: var(--fuente-titulos);
            font-size: 1.4em;
            font-weight: 700;
            margin-bottom: 10px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            color: var(--color-texto-principal);
        }

        .card-description {
            font-size: 0.9em;
            color: var(--color-texto-secundario);
            flex-grow: 1;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .card-button {
            margin-top: 15px;
            width: 100%;
            padding: 12px;
            border: none;
            background-color: var(--color-primario);
            color: #fff;
            border-radius: var(--borde-radio);
            font-weight: 600;
            cursor: pointer;
            text-align: center;
            text-decoration: none;
            display: block;
            transition: all 0.3s ease;
        }

        .card-button:hover {
            background-color: #c2185b;
            transform: scale(1.05);
        }

        /* Modal de producto */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 237, 242, 0.7);
            backdrop-filter: blur(8px);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.4s ease, visibility 0s 0.4s;
        }

        .modal-overlay.visible {
            opacity: 1;
            visibility: visible;
            transition: opacity 0.4s ease;
        }

        @keyframes modal-anim-in {
            from {
                transform: translateY(-50px) scale(0.95);
                opacity: 0;
            }
            to {
                transform: translateY(0) scale(1);
                opacity: 1;
            }
        }

        .modal-container {
            background: #fff;
            max-width: 800px;
            width: 90%;
            max-height: 90vh;
            border-radius: var(--borde-radio);
            border: 1px solid var(--color-secundario);
            box-shadow: 0 10px 30px var(--color-sombra);
            display: flex;
            flex-direction: column;
            opacity: 0;
            position: relative;
            overflow: hidden;
        }

        .modal-overlay.visible .modal-container {
            animation: modal-anim-in 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            border-bottom: 1px solid var(--color-tarjeta-borde);
            position: relative;
            z-index: 10;
        }

        #modal-title,
        #terms-modal-title {
            font-family: var(--fuente-titulos);
            font-size: 2em;
            font-weight: 700;
            color: var(--color-primario);
        }

        .modal-close-button {
            font-size: 2em;
            background: none;
            border: none;
            cursor: pointer;
            color: var(--color-texto-secundario);
            line-height: 1;
            transition: color 0.3s, transform 0.3s;
        }

        .modal-close-button:hover {
            color: var(--color-primario);
            transform: rotate(90deg);
        }

        .modal-body {
            padding: 25px;
            overflow-y: auto;
            position: relative;
            z-index: 10;
        }

        .modal-body h3 {
            font-family: var(--fuente-titulos);
            margin-top: 20px;
            margin-bottom: 10px;
            color: var(--color-texto-principal);
        }

        .modal-body p {
            margin-bottom: 15px;
        }

        .modal-body ul {
            margin-left: 20px;
            margin-bottom: 15px;
        }

        .modal-body li {
            margin-bottom: 8px;
        }

        .modal-media-container {
            width: 100%;
            margin-bottom: 25px;
            position: relative;
        }

        #modal-image,
        #modal-video {
            width: 100%;
            max-height: 500px;
            border-radius: var(--borde-radio);
            display: none;
        }

        #modal-video {
            pointer-events: none;
        }

        #modal-description {
            color: var(--color-texto-principal);
            margin-bottom: 25px;
            font-size: 1.05em;
        }

        .modal-button {
            display: inline-block;
            padding: 12px 25px;
            background-color: #25D366;
            color: #fff;
            text-decoration: none;
            border-radius: var(--borde-radio);
            font-weight: 600;
            text-align: center;
            transition: all 0.3s ease;
            align-self: flex-start;
        }

        .modal-button:hover {
            background-color: #128C7E;
            transform: scale(1.05);
        }

        /* Corazones animados en el modal */
        .modal-corazon {
            position: absolute;
            background-color: var(--color-primario);
            opacity: 0.7;
            z-index: 1;
            pointer-events: none;
        }

        .modal-corazon::before,
        .modal-corazon::after {
            content: "";
            position: absolute;
            width: 100%;
            height: 100%;
            background-color: inherit;
            border-radius: 50%;
        }

        .modal-corazon::before {
            top: -50%;
            left: 0;
        }

        .modal-corazon::after {
            top: 0;
            left: -50%;
        }

        /* Ositos animados en el modal */
        .modal-osito {
            position: absolute;
            font-size: 24px;
            opacity: 0.7;
            z-index: 1;
            pointer-events: none;
            animation: flotar-osito 15s infinite ease-in-out;
        }

        @keyframes flotar-corazon {
            0% {
                transform: translateY(0) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 0.7;
            }
            90% {
                opacity: 0.7;
            }
            100% {
                transform: translateY(-100vh) rotate(360deg);
                opacity: 0;
            }
        }

        @keyframes flotar-osito {
            0% {
                transform: translateY(0) rotate(0deg) scale(1);
                opacity: 0;
            }
            10% {
                opacity: 0.7;
            }
            50% {
                transform: translateY(-50vh) rotate(180deg) scale(1.2);
            }
            90% {
                opacity: 0.7;
            }
            100% {
                transform: translateY(-100vh) rotate(360deg) scale(1);
                opacity: 0;
            }
        }

        /* Marca de agua */
        .watermark-overlay::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90%;
            z-index: 5;
            color: rgba(255, 255, 255, 0.5);
            font-size: 1.4em;
            font-weight: 600;
            text-shadow: 1px 1px 8px rgba(0, 0, 0, 0.7);
            pointer-events: none;
            font-family: var(--fuente-principal);
            text-align: center;
            line-height: 1.2;
        }

        .product-card .watermark-overlay::after {
            font-size: 1em;
            font-weight: 500;
        }

        .video-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 10;
            cursor: default;
            background: transparent;
        }

        /* Paginaci√≥n */
        #pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 30px 0;
            gap: 10px;
        }

        .page-btn {
            padding: 10px 18px;
            border: 1px solid var(--color-secundario);
            background-color: #fff;
            color: var(--color-primario);
            cursor: pointer;
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .page-btn:hover:not(:disabled) {
            background-color: var(--color-secundario);
            color: var(--color-texto-principal);
        }

        .page-btn.active {
            background-color: var(--color-primario);
            color: #fff;
            border-color: var(--color-primario);
        }

        .page-btn:disabled {
            cursor: not-allowed;
            opacity: 0.5;
        }

        /* Footer */
        .footer {
            background-color: transparent;
            text-align: center;
            padding: 40px 20px;
            margin-top: 40px;
            color: var(--color-texto-secundario);
        }

        .footer a {
            color: var(--color-primario);
            text-decoration: none;
            transition: color 0.3s ease;
            cursor: pointer;
        }

        .footer a:hover {
            text-decoration: underline;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                align-items: flex-start;
            }

            .controles-busqueda,
            #buscador,
            #ordenar {
                width: 100%;
            }

            #product-grid {
                grid-template-columns: 1fr;
                gap: 25px;
            }

            .product-card {
                width: 100%;
            }

            #modal-title,
            #terms-modal-title {
                font-size: 1.5em;
            }

            .watermark-overlay::after {
                font-size: 1.1em;
            }

            .product-card .watermark-overlay::after {
                font-size: 0.8em;
            }
        }
    </style>
</head>
<body>
    <!-- Corazones flotantes de fondo -->
    <div class="corazones-fondo">
        <div class="corazon"></div>
        <div class="corazon"></div>
        <div class="corazon"></div>
        <div class="corazon"></div>
        <div class="corazon"></div>
        <div class="corazon"></div>
        <div class="corazon"></div>
        <div class="corazon"></div>
        <div class="corazon"></div>
        <div class="corazon"></div>
        <div class="corazon"></div>
        <div class="corazon"></div>
    </div>

    <!-- Encabezado -->
    <header class="header">
        <a href="#" class="logo">Lesly</a>
        <div class="controles-busqueda">
            <div class="buscador-wrapper">
                <input type="text" id="buscador" class="input-estilizado" placeholder="Buscar un regalo...">
            </div>
            <select id="ordenar" class="input-estilizado">
                <option value="recientes">M√°s recientes</option>
                <option value="a-z">Nombre (A-Z)</option>
                <option value="z-a">Nombre (Z-A)</option>
            </select>
        </div>
    </header>

    <!-- Contenido principal -->
    <main class="container">
        <div id="product-grid"></div>
        <div id="pagination"></div>
    </main>

    <!-- Modal de producto -->
    <div id="modal" class="modal-overlay">
        <div class="modal-container" role="dialog" aria-modal="true" aria-labelledby="modal-title">
            <header class="modal-header">
                <h2 id="modal-title">T√≠tulo del Producto</h2>
                <button class="modal-close-button" aria-label="Cerrar modal">&times;</button>
            </header>
            <div class="modal-body">
                <div class="modal-media-container watermark-overlay">
                    <img id="modal-image" src="" alt="Imagen del producto">
                    <iframe id="modal-video" src="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                    <div class="video-overlay"></div>
                </div>
                <p id="modal-description">Aqu√≠ va la descripci√≥n completa del producto.</p>
                <a id="modal-whatsapp-button" class="modal-button" href="#" target="_blank" rel="noopener noreferrer">Consultar por WhatsApp</a>
            </div>
        </div>
    </div>

    <!-- Modal de t√©rminos y pol√≠ticas -->
    <div id="terms-modal" class="modal-overlay">
        <div class="modal-container" role="dialog" aria-modal="true" aria-labelledby="terms-modal-title">
            <header class="modal-header">
                <h2 id="terms-modal-title"></h2>
                <button class="modal-close-button" aria-label="Cerrar modal">&times;</button>
            </header>
            <div id="terms-modal-body" class="modal-body"></div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <p>&copy; 2025 Lesly con amor. Todos los derechos reservados.</p>
        <p><a id="open-policies-link">Pol√≠ticas de Reconciliaci√≥n</a> | <a id="open-terms-link">T√©rminos del Coraz√≥n</a></p>
    </footer>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            // Constantes y configuraci√≥n inicial
            const WHATSAPP_NUMBER = "51918072862";
            const ITEMS_PER_PAGE = 12;
            
            // Lista de productos
            const productos = [
                {
                    id: 1,
                    tipo: "video-local",
                    media: "1.mp4",
                    titulo: "Video Local Sorpresa 1",
                    descripcion: "Un video personalizado con tus fotos, m√∫sica y un mensaje especial para esa persona que tanto quieres. Ideal para aniversarios, reconciliaciones o simplemente para decir 'te quiero'.",
                    descripcionCorta: "Video personalizado con tus fotos y m√∫sica favorita.",
                    precio: "S/ 2"
                },
                {
                    id: 2,
                    tipo: "video-local",
                    media: "2.mp4",
                    titulo: "Video Local Especial 2",
                    descripcion: "Un hermoso video con efectos especiales que durar√° a√±os, simbolizando un amor que no se marchita. Viene con una tarjeta para tu dedicatoria.",
                    descripcionCorta: "Video especial con efectos personalizados.",
                    precio: "S/ 250"
                },
                {
                    id: 3,
                    tipo: "video-local",
                    media: "1.mp4",
                    titulo: "Video Local Rom√°ntico 3",
                    descripcion: "Un video rom√°ntico con las canciones que marcaron su historia. Perfecto para sorprender a esa persona especial en su cumplea√±os o aniversario.",
                    descripcionCorta: "Video rom√°ntico con sus canciones favoritas.",
                    precio: "S/ 80"
                },
                {
                    id: 4,
                    tipo: "video-local",
                    media: "2.mp4",
                    titulo: "Video Local Divertido 4",
                    descripcion: "Un video divertido con momentos graciosos y especiales que har√°n re√≠r a esa persona que tanto quieres. Ideal para levantar el √°nimo.",
                    descripcionCorta: "Video divertido con momentos especiales.",
                    precio: "S/ 120"
                },
                {
                    id: 5,
                    tipo: "video-local",
                    media: "1.mp4",
                    titulo: "Video Local Conmovedor 5",
                    descripcion: "Un video conmovedor que recopila los momentos m√°s especiales de su relaci√≥n. Perfecto para reconciliaciones o expresar tus sentimientos.",
                    descripcionCorta: "Video conmovedor con momentos especiales.",
                    precio: "S/ 150"
                },
                {
                    id: 6,
                    tipo: "video-local",
                    media: "2.mp4",
                    titulo: "Video Local Creativo 6",
                    descripcion: "Un video creativo con animaciones y efectos especiales que sorprender√°n a esa persona especial. Ideal para personas originales y diferentes.",
                    descripcionCorta: "Video creativo con animaciones especiales.",
                    precio: "S/ 200"
                },
                {
                    id: 7,
                    tipo: "video",
                    media: "https://www.youtube.com/watch?v=SRm2Ch4oFWs",
                    titulo: "Mapa Estelar Personalizado",
                    descripcion: "Un cuadro con la posici√≥n exacta de las estrellas en una fecha y lugar especial para ustedes: su primer beso, su aniversario, etc. Un regalo √∫nico y memorable.",
                    descripcionCorta: "Cuadro con el mapa de las estrellas de un d√≠a especial."
                }
            ];

            // Estado de la aplicaci√≥n
            let estado = {
                pagina: 1,
                filtro: "",
                orden: "recientes"
            };

            // Elementos del DOM
            const productGrid = document.getElementById("product-grid");
            const pagination = document.getElementById("pagination");
            const buscador = document.getElementById("buscador");
            const ordenar = document.getElementById("ordenar");
            const modal = document.getElementById("modal");
            const modalTitle = document.getElementById("modal-title");
            const modalImage = document.getElementById("modal-image");
            const modalVideo = document.getElementById("modal-video");
            const modalDescription = document.getElementById("modal-description");
            const modalWhatsappButton = document.getElementById("modal-whatsapp-button");

            // Funci√≥n para crear corazones animados en el modal
            function crearCorazonesAnimados() {
                const modalContainer = document.querySelector("#modal .modal-container");
                
                // Limpiar corazones existentes
                const corazonesExistentes = modalContainer.querySelectorAll('.modal-corazon, .modal-osito');
                corazonesExistentes.forEach(corazon => corazon.remove());
                
                // Crear corazones
                for (let i = 0; i < 15; i++) {
                    const corazon = document.createElement("div");
                    corazon.className = "modal-corazon";
                    
                    // Tama√±o aleatorio
                    const size = Math.random() * 20 + 10; // Entre 10px y 30px
                    corazon.style.width = `${size}px`;
                    corazon.style.height = `${size}px`;
                    
                    // Posici√≥n aleatoria
                    corazon.style.left = `${Math.random() * 100}%`;
                    corazon.style.bottom = `-${size}px`;
                    
                    // Color aleatorio (tonos de rosa y rojo)
                    const colores = ['#e91e63', '#f06292', '#ec407a', '#d81b60', '#c2185b', '#ad1457'];
                    corazon.style.backgroundColor = colores[Math.floor(Math.random() * colores.length)];
                    
                    // Animaci√≥n con duraci√≥n y retraso aleatorios
                    const duracion = Math.random() * 10 + 10; // Entre 10s y 20s
                    const retraso = Math.random() * 5; // Entre 0s y 5s
                    corazon.style.animation = `flotar-corazon ${duracion}s ${retraso}s infinite ease-in-out`;
                    
                    modalContainer.appendChild(corazon);
                }
                
                // Crear ositos
                const ositos = ['üß∏', 'üêª', '‚ù§Ô∏è', 'üíï', 'üíñ', 'üíó', 'üíì', 'üíû'];
                for (let i = 0; i < 8; i++) {
                    const osito = document.createElement("div");
                    osito.className = "modal-osito";
                    osito.textContent = ositos[Math.floor(Math.random() * ositos.length)];
                    
                    // Tama√±o aleatorio
                    const fontSize = Math.random() * 20 + 20; // Entre 20px y 40px
                    osito.style.fontSize = `${fontSize}px`;
                    
                    // Posici√≥n aleatoria
                    osito.style.left = `${Math.random() * 100}%`;
                    osito.style.bottom = `-${fontSize}px`;
                    
                    // Animaci√≥n con duraci√≥n y retraso aleatorios
                    const duracion = Math.random() * 10 + 15; // Entre 15s y 25s
                    const retraso = Math.random() * 5; // Entre 0s y 5s
                    osito.style.animation = `flotar-osito ${duracion}s ${retraso}s infinite ease-in-out`;
                    
                    modalContainer.appendChild(osito);
                }
            }

            // Funci√≥n para abrir el modal de producto
            function abrirModalProducto(producto) {
                modalTitle.textContent = producto.titulo;
                
                if (producto.tipo === "video") {
                    modalImage.style.display = "none";
                    modalVideo.style.display = "block";
                    // Configurar el iframe sin controles y con autoplay
                    modalVideo.src = producto.media.replace("watch?v=", "embed/") + "?autoplay=1&mute=1&controls=0&loop=1&modestbranding=1&rel=0&showinfo=0&disablekb=1&fs=0&playsinline=1";
                } else if (producto.tipo === "video-local") {
                    modalImage.style.display = "none";
                    modalVideo.style.display = "none";
                    
                    // Crear un elemento de video local
                    const localVideo = document.createElement("video");
                    localVideo.id = "modal-local-video";
                    localVideo.width = "100%";
                    localVideo.style.maxHeight = "500px";
                    localVideo.style.borderRadius = "var(--borde-radio)";
                    localVideo.style.display = "block";
                    localVideo.autoplay = true;
                    localVideo.muted = true;
                    localVideo.loop = true;
                    localVideo.playsInline = true;
                    localVideo.controls = false;
                    localVideo.preload = "metadata";
                    
                    const source = document.createElement("source");
                    source.src = producto.media;
                    source.type = "video/mp4";
                    
                    localVideo.appendChild(source);
                    
                    // Reemplazar el iframe con el video local
                    const modalMediaContainer = document.querySelector(".modal-media-container");
                    const existingVideo = document.getElementById("modal-local-video");
                    if (existingVideo) {
                        existingVideo.remove();
                    }
                    modalMediaContainer.insertBefore(localVideo, modalMediaContainer.firstChild.nextSibling);
                } else {
                    modalVideo.style.display = "none";
                    modalImage.style.display = "block";
                    modalImage.src = producto.media || "";
                    modalImage.alt = `Imagen de ${producto.titulo}`;
                }
                
                modalDescription.textContent = producto.descripcion;
                
                const mensaje = encodeURIComponent(`Hola, ¬øme das informaci√≥n sobre "${producto.titulo}"?`);
                modalWhatsappButton.href = `https://wa.me/${WHATSAPP_NUMBER}?text=${mensaje}`;
                
                modal.classList.add("visible");
                document.body.style.overflow = "hidden";
                
                // Crear corazones animados
                setTimeout(crearCorazonesAnimados, 100);
            }

            // Funci√≥n para cerrar el modal de producto
            function cerrarModalProducto() {
                modal.classList.remove("visible");
                document.body.style.overflow = "";
                
                // Detener el video al cerrar el modal
                if (modalVideo.style.display === "block") {
                    modalVideo.src = "";
                }
                
                // Detener el video local si existe
                const localVideo = document.getElementById("modal-local-video");
                if (localVideo) {
                    localVideo.pause();
                    localVideo.remove();
                }
                
                // Limpiar corazones animados
                const modalContainer = document.querySelector("#modal .modal-container");
                const corazones = modalContainer.querySelectorAll('.modal-corazon, .modal-osito');
                corazones.forEach(corazon => corazon.remove());
            }

            // Funci√≥n para renderizar productos
            function renderizarProductos() {
                // Filtrar productos seg√∫n el t√©rmino de b√∫squeda
                let productosFiltrados = productos.filter(producto => 
                    producto.titulo.toLowerCase().includes(estado.filtro.toLowerCase())
                );
                
                // Ordenar productos seg√∫n el criterio seleccionado
                const productosOrdenados = [...productosFiltrados].sort((a, b) => {
                    if (estado.orden === "a-z") {
                        return a.titulo.localeCompare(b.titulo);
                    } else if (estado.orden === "z-a") {
                        return b.titulo.localeCompare(a.titulo);
                    } else {
                        return productos.indexOf(a) - productos.indexOf(b);
                    }
                });
                
                // Calcular productos para la p√°gina actual
                const startIndex = (estado.pagina - 1) * ITEMS_PER_PAGE;
                const endIndex = startIndex + ITEMS_PER_PAGE;
                const productosPagina = productosOrdenados.slice(startIndex, endIndex);
                
                // Limpiar grid de productos
                productGrid.innerHTML = "";
                
                // Mostrar mensaje si no hay resultados
                if (productosPagina.length === 0) {
                    productGrid.innerHTML = "<p>No encontramos regalos con ese nombre, ¬°intenta de nuevo!</p>";
                    return;
                }
                
                // Renderizar cada producto
                for (const producto of productosPagina) {
                    const mensaje = encodeURIComponent(`Hola, ¬øme das informaci√≥n sobre "${producto.titulo}"?`);
                    const whatsappUrl = `https://wa.me/${WHATSAPP_NUMBER}?text=${mensaje}`;
                    
                    let mediaContent;
                    if (producto.tipo === "video") {
                        // Usar iframe en lugar de video para YouTube
                        mediaContent = `<iframe class="card-media" src="${producto.media.replace("watch?v=", "embed/")}?autoplay=1&mute=1&controls=0&loop=1&modestbranding=1&rel=0&showinfo=0&disablekb=1&fs=0&playsinline=1" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>`;
                    } else if (producto.tipo === "video-local") {
                        // Usar elemento video para videos locales
                        mediaContent = `
                            <video class="card-media" autoplay muted loop playsinline preload="metadata" controls="false">
                                <source src="${producto.media}" type="video/mp4">
                            </video>
                        `;
                    } else {
                        mediaContent = `<img class="card-media" src="${producto.media || ""}" alt="Imagen de ${producto.titulo}" loading="lazy">`;
                    }
                    
                    const card = document.createElement("div");
                    card.className = "product-card";
                    card.dataset.id = producto.id;
                    card.setAttribute("role", "button");
                    card.tabIndex = 0;
                    card.style.animationDelay = `${productosPagina.indexOf(producto) * 80}ms`;
                    
                    card.innerHTML = `
                        <div class="card-media-container watermark-overlay">
                            ${mediaContent}
                            ${producto.precio ? `<span class="card-price">${producto.precio}</span>` : ""}
                            <div class="video-overlay"></div>
                        </div>
                        <div class="card-content">
                            <div>
                                <h3 class="card-title">${producto.titulo}</h3>
                                <p class="card-description">${producto.descripcionCorta}</p>
                            </div>
                            <a href="${whatsappUrl}" class="card-button" target="_blank" rel="noopener noreferrer" onclick="event.stopPropagation()">
                                Me interesa
                            </a>
                        </div>
                    `;
                    
                    productGrid.appendChild(card);
                }
                
                // Configurar observadores de intersecci√≥n para videos
                configurarObservadoresVideos();
                
                // Renderizar paginaci√≥n
                renderizarPaginacion(productosOrdenados.length);
            }

            // Funci√≥n para configurar observadores de intersecci√≥n para videos
            function configurarObservadoresVideos() {
                const videos = document.querySelectorAll('.card-media-container iframe, .card-media-container video');
                
                if (videos.length === 0) return;
                
                const opciones = {
                    root: null,
                    rootMargin: '0px',
                    threshold: 0.5
                };
                
                const observador = new IntersectionObserver((entradas) => {
                    entradas.forEach(entrada => {
                        const elemento = entrada.target;
                        
                        if (entrada.isIntersecting) {
                            // Si el video es visible, reproducirlo
                            if (elemento.tagName === 'IFRAME') {
                                const src = elemento.src;
                                if (!src.includes('autoplay=1')) {
                                    elemento.src = src.replace('autoplay=0', 'autoplay=1');
                                }
                            } else if (elemento.tagName === 'VIDEO') {
                                elemento.play().catch(e => console.log("Error al reproducir video:", e));
                            }
                        } else {
                            // Si el video no es visible, pausarlo
                            if (elemento.tagName === 'IFRAME') {
                                const src = elemento.src;
                                if (src.includes('autoplay=1')) {
                                    elemento.src = src.replace('autoplay=1', 'autoplay=0');
                                }
                            } else if (elemento.tagName === 'VIDEO') {
                                elemento.pause();
                            }
                        }
                    });
                }, opciones);
                
                videos.forEach(video => {
                    observador.observe(video);
                });
            }

            // Funci√≥n para renderizar la paginaci√≥n
            function renderizarPaginacion(totalItems) {
                const totalPages = Math.ceil(totalItems / ITEMS_PER_PAGE);
                
                // Limpiar paginaci√≥n
                pagination.innerHTML = "";
                
                // No mostrar paginaci√≥n si solo hay una p√°gina
                if (totalPages <= 1) return;
                
                // Funci√≥n para crear un bot√≥n de p√°gina
                const crearBotonPagina = (texto, pagina, disabled = false) => {
                    const boton = document.createElement("button");
                    boton.innerHTML = texto;
                    boton.className = "page-btn";
                    boton.disabled = disabled;
                    
                    if (pagina === estado.pagina) {
                        boton.classList.add("active");
                    }
                    
                    boton.addEventListener("click", () => {
                        estado.pagina = pagina;
                        renderizarProductos();
                    });
                    
                    return boton;
                };
                
                // Bot√≥n "Anterior"
                pagination.appendChild(crearBotonPagina("¬´", estado.pagina - 1, estado.pagina === 1));
                
                // Botones de p√°gina
                for (let i = 1; i <= totalPages; i++) {
                    pagination.appendChild(crearBotonPagina(i, i));
                }
                
                // Bot√≥n "Siguiente"
                pagination.appendChild(crearBotonPagina("¬ª", estado.pagina + 1, estado.pagina === totalPages));
            }

            // Event Listeners
            modal.querySelector(".modal-close-button").addEventListener("click", cerrarModalProducto);
            modal.addEventListener("click", (e) => {
                if (e.target === modal) cerrarModalProducto();
            });
            
            productGrid.addEventListener("click", (e) => {
                const card = e.target.closest(".product-card");
                if (card && !e.target.closest(".card-button")) {
                    const producto = productos.find(p => p.id === parseInt(card.dataset.id, 10));
                    if (producto) abrirModalProducto(producto);
                }
            });
            
            buscador.addEventListener("input", (e) => {
                estado.filtro = e.target.value;
                estado.pagina = 1;
                renderizarProductos();
            });
            
            ordenar.addEventListener("change", (e) => {
                estado.orden = e.target.value;
                estado.pagina = 1;
                renderizarProductos();
            });
            
            // Modal de t√©rminos y pol√≠ticas
            const termsModal = document.getElementById("terms-modal");
            const termsModalTitle = document.getElementById("terms-modal-title");
            const termsModalBody = document.getElementById("terms-modal-body");
            const openTermsLink = document.getElementById("open-terms-link");
            const openPoliciesLink = document.getElementById("open-policies-link");
            
            const termsContent = `
                <h3>üìë T√âRMINOS Y CONDICIONES</h3>
                <p><strong>√öltima actualizaci√≥n:</strong> ${new Date().toLocaleDateString("es-ES")}</p>
                <p><strong>1. Objeto del Contrato</strong><br>Estos T√©rminos y Condiciones regulan la compra y uso de productos digitales ofrecidos por el Vendedor (videos, plantillas, archivos de c√≥digo, entre otros). Al realizar la compra, el Comprador declara haber le√≠do, comprendido y aceptado √≠ntegramente estos T√©rminos.</p>
                <p><strong>2. Naturaleza de los Productos</strong><br>Todos los bienes son digitales y se entregan mediante descarga, enlace, acceso en l√≠nea u otro medio electr√≥nico. No se env√≠an productos f√≠sicos bajo ninguna modalidad.</p>
                <p><strong>3. Vigencia de los Productos Digitales</strong><br>El acceso a los Productos Digitales tiene una vigencia limitada. El acceso estar√° disponible como m√≠nimo por dos (2) semanas y como m√°ximo por un (1) mes contado desde la fecha de compra. Una vez vencido el plazo de vigencia, el Comprador perder√° el acceso al enlace o al Producto Digital, sin derecho a reembolso.</p>
                <p><strong>4. Compra y Pago</strong><br>La compra se considera efectiva una vez que el pago ha sido confirmado por los medios habilitados (Yape u otros). El Vendedor no est√° obligado a realizar la entrega hasta verificar la acreditaci√≥n total del pago.</p>
                <p><strong>5. Entrega de Productos</strong><br>Tras la confirmaci√≥n del pago, el Vendedor entregar√° el Producto Digital dentro del plazo indicado en la p√°gina oficial o canal de venta. En caso de indisponibilidad t√©cnica o error que impida la entrega, el Vendedor notificar√° al Comprador y podr√° optar por: a) reprogramar la entrega, o b) devolver el monto √≠ntegro abonado.</p>
                <p><strong>6. Reembolsos y Devoluciones</strong><br>Debido a la naturaleza de los productos digitales, no existen devoluciones ni reembolsos una vez entregado el producto. El √∫nico caso en que procede un reembolso es cuando el Vendedor no pueda entregar el producto adquirido.</p>
                <p><strong>7. Responsabilidad del Comprador</strong><br>El Comprador es responsable de asegurarse de que: a) El producto es compatible con su dispositivo o software. b) El producto corresponde a lo que realmente desea adquirir. El Vendedor no se responsabiliza si el producto no puede visualizarse, ejecutarse o utilizarse por limitaciones del dispositivo, falta de programas adecuados o configuraciones del Comprador.</p>
                <p><strong>8. Condiciones sobre Personalizaci√≥n</strong><br>El producto entregado corresponde exactamente al que aparece en la publicaci√≥n, video o paquete promocionado. Si el Comprador desea un producto adaptado o personalizado (ejemplo: cambiar textos, nombres, im√°genes, videos o enlaces), este tendr√° un costo adicional, el cual ser√° acordado con el Vendedor. √önicamente se aceptar√°n cambios cuando la publicaci√≥n expresamente lo indique, y solo en los t√©rminos detallados en dicha publicaci√≥n.</p>
                <p><strong>9. Derechos de Uso</strong><br>Los productos adquiridos son para uso personal, limitado y no transferible. Queda prohibida su reproducci√≥n, redistribuci√≥n, reventa o modificaci√≥n sin autorizaci√≥n expresa y por escrito del Vendedor.</p>
                <p><strong>10. Limitaci√≥n de Responsabilidad</strong><br>El Vendedor no se responsabiliza por da√±os indirectos, p√©rdida de datos, incompatibilidades t√©cnicas ni perjuicios derivados del uso inadecuado del producto. La responsabilidad m√°xima del Vendedor, en cualquier caso, se limita al importe pagado por el producto objeto de reclamo.</p>
                <p><strong>11. Ley Aplicable y Jurisdicci√≥n</strong><br>Estos T√©rminos se rigen por las leyes de la Rep√∫blica del Per√∫. Cualquier controversia ser√° resuelta por los tribunales competentes de Lima, salvo disposici√≥n legal imperativa en contrario.</p>
            `;
            
            const policiesContent = `
                <h3>üìú POL√çTICAS DE SERVICIO</h3>
                <p><strong>Pol√≠tica de Entrega</strong><br>La entrega se realiza √∫nicamente por medios digitales. Una vez pagado el producto, el Comprador recibir√° el acceso o archivo en el plazo indicado.</p>
                <p><strong>Pol√≠tica de Vigencia</strong><br>Todos los accesos a Productos Digitales tendr√°n una duraci√≥n limitada:<br>M√≠nimo: 2 semanas<br>M√°ximo: 1 mes<br>Al finalizar el plazo de vigencia, el acceso se desactiva autom√°ticamente y el Comprador no podr√° reclamar continuidad, renovaci√≥n gratuita ni reembolso.</p>
                <p><strong>Pol√≠tica de Devoluciones</strong><br>No se realizan devoluciones ni cambios despu√©s de la entrega del producto digital. √önicamente en caso de que el Vendedor no pueda entregar lo adquirido, se proceder√° con el reembolso total.</p>
                <p><strong>Pol√≠tica de Compatibilidad</strong><br>El Comprador debe verificar previamente la compatibilidad del producto con su dispositivo o software. El Vendedor no se responsabiliza por fallas de visualizaci√≥n, instalaci√≥n o ejecuci√≥n debido a limitaciones t√©cnicas del dispositivo del Comprador.</p>
                <p><strong>Pol√≠tica de Personalizaci√≥n</strong><br>El producto entregado es id√©ntico al mostrado en la publicaci√≥n o video promocional. Si el Comprador requiere un producto personalizado (ejemplo: modificaciones en textos, enlaces, im√°genes o videos), deber√° pagar un costo adicional, el cual ser√° acordado previamente. Solo se realizar√°n cambios cuando la publicaci√≥n lo indique expresamente y se limitar√°n a los ajustes descritos en la misma.</p>
                <p><strong>Pol√≠tica de Contacto y Soporte</strong><br>Para reclamos o incidencias, el Comprador deber√° comunicarse dentro de las 48 horas siguientes a la compra a trav√©s de los canales oficiales de contacto publicados. El soporte se limita a la entrega y acceso del producto adquirido; no incluye personalizaci√≥n, instalaci√≥n ni asesor√≠as t√©cnicas adicionales salvo acuerdo previo.</p>
            `;
            
            function abrirModalTerminos(tipo) {
                if (tipo === "terms") {
                    termsModalTitle.textContent = "T√©rminos del Coraz√≥n";
                    termsModalBody.innerHTML = termsContent;
                } else {
                    termsModalTitle.textContent = "Pol√≠ticas de Reconciliaci√≥n";
                    termsModalBody.innerHTML = policiesContent;
                }
                
                termsModal.classList.add("visible");
                document.body.style.overflow = "hidden";
                termsModalBody.scrollTop = 0;
            }
            
            function cerrarModalTerminos() {
                termsModal.classList.remove("visible");
                document.body.style.overflow = "";
            }
            
            openTermsLink.addEventListener("click", () => abrirModalTerminos("terms"));
            openPoliciesLink.addEventListener("click", () => abrirModalTerminos("policies"));
            
            termsModal.querySelector(".modal-close-button").addEventListener("click", cerrarModalTerminos);
            termsModal.addEventListener("click", (e) => {
                if (e.target === termsModal) cerrarModalTerminos();
            });
            
            // Cerrar modales con la tecla Escape
            document.addEventListener("keydown", (e) => {
                if (e.key === "Escape") {
                    if (modal.classList.contains("visible")) cerrarModalProducto();
                    if (termsModal.classList.contains("visible")) cerrarModalTerminos();
                }
            });
            
            // Prevenir clic derecho en videos
            document.addEventListener("contextmenu", (e) => {
                if (e.target.tagName === "VIDEO" || e.target.tagName === "IFRAME") {
                    e.preventDefault();
                }
            });
            
            // Renderizar productos iniciales
            renderizarProductos();
        });
    </script>
</body>
